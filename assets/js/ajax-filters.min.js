jQuery(document).ready(function(a){function b(b,c){if($supports_html5_history){var d=b.find(".job_filters"),f=a(d).serialize(),g=a("div.job_listings").index(b),h=d.find("#search_keywords").val()?"search_keywords="+encodeURIComponent(d.find("#search_keywords").val()):"",i=d.find("#search_location").val()?"search_location="+encodeURIComponent(d.find("#search_location").val()):"",j="",k=e+(h||i||j?"?":"")+h+(h&&i?"&":"")+i+((h||i)&&j?"&":"")+j;document.location.href!==k&&window.history.pushState({id:"job_manager_state",page:c,data:f,index:g},"",k)}}function c(a){for(var b,c=/\+/g,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f=window.location.search.substring(1),g={};b=d.exec(f);)g[e(b[1])]=e(b[2]);return g}var d=[];a(".job_listings").on("update_results",function(c,e,f,g){var h="",i=a(this),j=i.find(".job_filters"),k=i.find(".showing_jobs"),l=i.find(".job_listings"),m=i.data("per_page"),n=i.data("orderby"),o=i.data("order"),p=i.data("featured"),q=i.data("filled"),r=a("div.job_listings").index(this);if(!(0>r)){if(d[r]&&d[r].abort(),f||(a(l).addClass("loading"),a("li.job_listing, li.no_job_listings_found",l).css("visibility","hidden"),e>1&&1!=i.data("show_pagination")?a(l).before('<a class="load_more_jobs load_previous" href="#"><strong>'+job_manager_ajax_filters.i18n_load_prev_listings+"</strong></a>"):i.find(".load_previous").remove(),i.find(".load_more_jobs").data("page",e)),1==i.data("show_filters")){var s=[];a(':input[name="filter_job_type[]"]:checked, :input[name="filter_job_type[]"][type="hidden"], :input[name="filter_job_type"]',j).each(function(){s.push(a(this).val())});var t=j.find(':input[name^="search_categories"]').map(function(){return a(this).val()}).get(),u="",v="",w=j.find(':input[name="search_keywords"]'),x=j.find(':input[name="search_location"]');w.val()!==w.attr("placeholder")&&(u=w.val()),x.val()!==x.attr("placeholder")&&(v=x.val()),h={lang:job_manager_ajax_filters.lang,search_keywords:u,search_location:v,search_categories:t,filter_job_type:s,per_page:m,orderby:n,order:o,page:e,featured:p,filled:q,show_pagination:i.data("show_pagination"),form_data:j.serialize()}}else{var t=i.data("categories"),u=i.data("keywords"),v=i.data("location");t&&(t=t.split(",")),h={lang:job_manager_ajax_filters.lang,search_categories:t,search_keywords:u,search_location:v,per_page:m,orderby:n,order:o,page:e,featured:p,filled:q,show_pagination:i.data("show_pagination")}}d[r]=a.ajax({type:"POST",url:job_manager_ajax_filters.ajax_url.toString().replace("%%endpoint%%","get_listings"),data:h,success:function(c){if(c)try{c.showing?a(k).show().html("<span>"+c.showing+"</span>"+c.showing_links):a(k).hide(),c.showing_all?a(k).addClass("wp-job-manager-showing-all"):a(k).removeClass("wp-job-manager-showing-all"),c.html&&(f&&g?a(l).prepend(c.html):f?a(l).append(c.html):a(l).html(c.html)),1==i.data("show_pagination")?(i.find(".job-manager-pagination").remove(),c.pagination&&i.append(c.pagination)):(!c.found_jobs||c.max_num_pages<=e?a(".load_more_jobs:not(.load_previous)",i).hide():g||a(".load_more_jobs",i).show(),a(".load_more_jobs",i).removeClass("loading"),a("li.job_listing",l).css("visibility","visible")),a(l).removeClass("loading"),i.triggerHandler("updated_results",c),b(i,e)}catch(d){window.console&&console.log(d)}},error:function(a,b,c){window.console&&"abort"!==b&&console.log(b+": "+c)},statusCode:{404:function(){window.console&&console.log("Error 404: Ajax Endpoint cannot be reached. Go to Settings > Permalinks and save to resolve.")}}})}}),a("#search_keywords, #search_location, .job_types :input, #search_categories, .job-manager-filter").change(function(){var c=a(this).closest("div.job_listings");c.triggerHandler("update_results",[1,!1]),b(c,1)}).on("keyup",function(b){13===b.which&&a(this).trigger("change")}),a(".job_filters").on("click",".reset",function(){var c=a(this).closest("div.job_listings"),d=a(this).closest("form");return d.find(':input[name="search_keywords"], :input[name="search_location"], .job-manager-filter').not(':input[type="hidden"]').val("").trigger("chosen:updated"),d.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val(0).trigger("chosen:updated"),a(':input[name="filter_job_type[]"]',d).not(':input[type="hidden"]').attr("checked","checked"),c.triggerHandler("reset"),c.triggerHandler("update_results",[1,!1]),b(c,1),!1}),a(document.body).on("click",".load_more_jobs",function(){var c=a(this).closest("div.job_listings"),d=parseInt(a(this).data("page")||1),e=!1;return a(this).addClass("loading"),a(this).is(".load_previous")?(d-=1,e=!0,1===d?a(this).remove():a(this).data("page",d)):(d+=1,a(this).data("page",d),b(c,d)),c.triggerHandler("update_results",[d,!0,e]),!1}),a("div.job_listings").on("click",".job-manager-pagination a",function(){var c=a(this).closest("div.job_listings"),d=a(this).data("page");return b(c,d),c.triggerHandler("update_results",[d,!1]),a("body, html").animate({scrollTop:c.offset().top},600),!1}),a.isFunction(a.fn.chosen)&&(1==job_manager_ajax_filters.is_rtl&&a('select[name^="search_categories"]').addClass("chosen-rtl"),a('select[name^="search_categories"]').chosen({search_contains:!0})),window.history&&window.history.pushState?$supports_html5_history=!0:$supports_html5_history=!1;var e=document.location.href.split("?")[0],f=document.location.href.split("?")[1];console.log(f),$supports_html5_history&&a(window).on("onpopstate",function(b){console.log(c()),a(".job_filters").each(function(){var b=a(this).closest("div.job_listings"),c=(b.find(".job_filters"),1);a("div.job_listings").index(b);b.triggerHandler("update_results",[c,!1])})}),a(window).on("load",function(b){a(".job_filters").each(function(){var b=a(this).closest("div.job_listings"),c=b.find(".job_filters"),d=1,e=a("div.job_listings").index(b);if(window.history.state&&window.location.hash){var f=window.history.state;f.id&&"job_manager_state"===f.id&&e==f.index&&(d=f.page,c.deserialize(f.data),c.find(':input[name^="search_categories"]').not(':input[type="hidden"]').trigger("chosen:updated"))}b.triggerHandler("update_results",[d,!1])})})});